{% include "./common/header.html" %}
<link rel="stylesheet" href="{{ url_for('static',filename='./requirements/requirements.css') }}">
<script type="text/javascript" src="{{url_for('static',filename='./requirements/requirements.js') }}"></script>

<body onload="showThis({{profile}})">

    <div>
        <ul class="split left">
            <li>
                <h4 onclick="showThis(2)">Supplier profile</h4><br>
            </li>
            <li>
                <h4 onclick="showThis(3)" id="buyerTab">Buyer profile</h4>
            </li>
            <li style="margin-left: 25px; display: none" id="createReqTab">
                <h4 onclick="showThis(1)">Create Request</h4>
            </li>
        </ul>
    </div>
<center>
    <div id="thisDiv1" class="split1 right">
        <h1 style="color:#1a1f71">Create Your Request</h1>
        <form name="requirementForm" action="" onsubmit="return validateForm()" method="post" required>

            <div id="requestForm" class="containerForm ">
                <label for="title1">Title</label>
                <input type="text" name="title" id="title1" placeholder="Item Name" required />
                <label for="requesterName">Merchant Business Name</label>
                <input type="text" name="requesterName" id="requesterName" value="{{registeredName}}" readonly />
                <label for="description">Description</label>
                <textarea id="description" name="description" placeholder="Write About Your Requirement...">
                    </textarea>
                <label for="Quantity">Quantity Required: </label>
                <input type="number" name="Quantity" id="Quantity" style="height:50px" min="1"
                    placeholder="Quantity Required" required /> <br>
                <label for="Price">Amount in Rs: </label>
                <input type="number" name="Price" id="Price" style="height:50px" placeholder="Expected Amount" />
                <br><br>
                <input name="createRequest" class="button" type="submit" value="Post Request">

            </div>
        </form>
    </div>
    <div id="thisDiv2" style="display: none" class="split1 right">
        <h1>Your supplier profile for requirements</h1>
        <form class="example" method="post" action="" style="margin:auto;max-width:600px">
            <select name="filtersupplier">
                {% if choice=='P' %}
                <option value="P" selected>Open posts</option>
                {% else %}
                <option value="P">Open posts</option>{% endif %}
                {% if choice=='A' %}
                <option value="A" selected>Approved by buyer</option>
                {% else %}
                <option value="A">Approved by buyer</option>{% endif %}
                {% if choice=='R' %}
                <option value="R" selected>Rejected by buyer</option>
                {% else %}
                <option value="R">Rejected by buyer</option>{% endif %}
                {% if choice=='W' %}
                <option value="W" selected>Approved by you and pending</option>
                {% else %}
                <option value="W">Approved by you and pending</option>{% endif %}
                {% if choice=='E' %}
                <option value="E" selected>All approved by you</option>
                {% else %}
                <option value="E">All approved by you</option>{% endif %}
            </select>
            <input type="submit" class="button" onclick="javascript: form.action='/requirementssupplier';"
                value="Submit">
        </form><br><br><br>
        {% if choice=='A' %}
        <h1>Approved by buyer</h1>
        {% elif choice=='R' %}
        <h1>Rejected by buyer</h1>
        {% elif choice=='W' %}
        <h1>Approved by you and pending buyer's response</h1>
        {% elif choice=='E' %}
        <h1>All Approved by you</h1>
        {% else %}
        <h1>Open posts</h1><br>
        {% endif %}
        {% if sup_items %}
        <div class="container">
            <table class="table table-bordered">
                {% for item in sup_items %}
                <tr style="all: none;">
                    <td style="background-color: white; border: none;"></td>
                </tr>
                <tr class="header">
                    <td colspan="4">
                        <h3>{{item['Title']}}</h3><span style="float:right;">
                        {% if item['Status']=='Waiting for buyer response' %} <span style="color:orange">Status: Waiting for buyer response</span>
                        {% elif item['Status']=='Buyer accepted and paid' %}<span style="color:green">Status: Buyer accepted and paid</span></span>
                        {% elif item['Status']=='Rejected and closed' %}<span style="color:red">Status: Rejected and closed </span></span>
                        {% endif %}</span>
                        <h4>{{item['Description']}}</h4>
                        {% if item['Price']!='' and item['Price']!=None %} <h3>Price: {{item['Price']}}</h3> {% endif %}
                        <h3>Quantity: {{item['Quantity']}}</h3>
                    </td>
                    <tr>
                <td colspan="2"><b>Merchant details:<br>Name:</b>{% if item['Merchant.Name'] %}{{item['Merchant.Name']}} {% else %}{{item['Name']}} {% endif %}<br><b>Registered Shop:</b>{{item['RegisteredName']}}, {{item['Address']}}<br></td>
                {% if item['Product.ProductID'] %}
                <td colspan="1"><b>Product Details:<br>Name:</b> {{item['Name']}}<br><b>Description:</b> {{item['Product.Description']}}<br><b>Category:</b> {{item['Category']}}</td>
                <td colspan="1"><b>Contact details of merchant:<br>Email:</b> {{item['EmailID']}}<br><b>Phone:</b> {{item['ContactNumber']}}</td>
             {% elif choice=='P' %}
                <td colspan="1"><b>Contact details of merchant:<br>Email:</b> {{item['EmailID']}}<br><b>Phone:</b> {{item['ContactNumber']}}</td>
                <td colspan="1"><button >Approve request</button></td>
                   {% endif %}
                </tr>
                {% endfor %}
            </table>
        </div>
        {% else %}
        <h2> Could not find any match</h2>
        {% endif %}
        <!--
                <form method="post" action="/requirementssupplier">
            <h3>Title of requirement</h3>
            <div>
                <button type="button" class="button">Show Detailed Request and Contact Info after clicking and ask for
                    price id
                    approving</button>
                <div name="requestSending" style="opacity: 50%">
                    <h3> show Info</h3>
                    <label for="expectPrice">ExpectPrice: </label>
                    <input type="number" id="expectPrice" style="height: 40px ;width: 80px;" name="expectPrice"
                        value="1">
                    <label for="expectDelivery">ExpectDeliveryDate: </label>
                    <input type="date" id="expectDelivery" name="expectDelivery">

                    <input type="hidden" name="requirementID" value="requirementID">
                    <input type="submit" name="Approve" value="Approve">
                    <input type="submit" name="Reject" value="Reject">
                </div>
            </div>
        </form>
        -->
    </div>
    <div id="thisDiv3" style="display: none" class="split1 right">
        <!--  FIRST THIS -->
        <h1>Your buyer profile for requirements</h1>
        <form method="post" action="">
            <select name="filterbuyer">
                {% if buyer_choice=='R' %}
                <option value="R" selected>Your pending requests</option>
                {% else %}
                <option value="R">Your pending requests</option>{% endif %}
                {% if buyer_choice=='A' %}
                <option value="A" selected>Accepted by supplier</option>
                {% else %}
                <option value="A">Accepted by supplier</option>{% endif %}
                {% if buyer_choice=='D' %}
                <option value="D" selected>Completed requirements</option>
                {% else %}
                <option value="D">Completed requirements</option>{% endif %}
                {% if buyer_choice=='E' %}
                <option value="E" selected>All requests</option>
                {% else %}
                <option value="E">All requests</option>{% endif %}
            </select>
            <input type="submit" value="filter" class="button" onclick="javascript: form.action='/requirementsbuyer';">
        </form>
        {% if buyer_choice=='A' %}
        <h2>Accepted</h2>
        {% elif buyer_choice=='D' %}
        <h2>Completed requests</h2>
        {% elif buyer_choice=='E' %}
        <h2>All requests</h2>
        {% elif buyer_choice=='R' %}
        <h2>Requests pending</h2>
        {% else %}
        <h2>Requests pending</h2>
        {% endif %}
        {% if buy_items %}
        <h2 style="color: #1a1f71;"></h2>
        <div class="container">
            <table class="table table-bordered">
                {% for item in buy_items %}
                <tr style="all: none;">
                    <td style="background-color: white; border: none;"></td>
                </tr>
                <tr class="header">
                    <td colspan="4">
                        <h3>{{item['Title']}}</h3><span style="float:right;">Status:
                        {% if item['Status']=='Pending' %} <span style="color:red">Pending</span>
                        {% elif item['Status']=='Done' %}<span style="color:blue">Closed</span></span>
                        {% elif item['Status']=='Accepted' %}<span style="color:green">Accepted by supplier</span></span>
                        {% endif %}</span>
                        <h3>{{item['Description']}}</h3>
                        {% if item['Price']!='' and item['Price']!=None %} <h3>Price: {{item['Price']}}</h3> {% endif %}
                        <h3>Quantity: {{item['Quantity']}}</h3>

                    </td>
                    {% if item['Status']=='Done' %}
                    <tr>
                    <td colspan="4"><b>Merchant:</b>{{item['Name']}}<br><b>Registered Shop:</b>{{item['RegisteredName']}}, {{item['Address']}}<br>
                    <b>Item:</b><br>{{item['Product.Name']}}<br><b>Description:</b> {{item['Product.Description']}}<br>
                    <b>Contact details of merchant:<br>Email:</b> {{item['EmailID']}}<br><b>Phone:</b> {{item['ContactNumber']}}</td>
                </tr>
                    {% elif item['Status']!='Pending' %} {% for x in item['Accepts'] %}
                <tr>
                <td colspan="1"><b>Merchant:</b> {{x['Name']}}<br><b>Registered Shop:</b> {{x['RegisteredName']}}, {{x['Address']}}</td>
                <td colspan="1"><b>Item:</b><br>{{x['Product.Name']}}<br><b>Description:</b> {{x['Product.Description']}}</td>
                <td colspan="1"><b>Contact details of merchant:<br>Email:</b> {{x['EmailID']}}<br><b>Phone:</b> {{x['ContactNumber']}}</td>
                <td><button >add to cart</button></td>
                </tr>
                {% endfor %}
                {% endif %}
                </tr>
                {% endfor %}
            </table>
        </div>
        {% else %}
        <h2> Could not find any match</h2>
        {% endif %}
    </div>
</center>
</body>
<!--
<form method="post" action="/requirementsbuyer">
            <div id="accept/reject">
                <h1>Your Request(one request example)</h1>
                <p>List of Interested Buyers</p>
                <div>
                    <input type="radio" name="buyer1" value="buyer1" id="buyer1" />
                    <label for="buyer1">buyer1</label>
                    <input type="hidden" name="requirementID" value="requirementID1">
                    <input type="submit" name="AC" value="ACCEPT DEAL" />
                </div>
                <div>
                    <input type="radio" name="buyer2" id="buyer2" value="buyer2" />
                    <label for="buyer2">buyer2</label>
                    <input type="hidden" name="requirementID" value="requirementID2">
                    <input type="submit" name="AC" value="ACCEPT DEAL" />
                </div>
                <div>
                    <input type="radio" name="buyer3" value="buyer3" id="buyer3" />
                    <label for="buyer3">buyer3</label>
                    <input type="hidden" name="requirementID" value="requirementID3">
                    <input type="submit" name="AC" value="ACCEPTDEAL" />
                </div>
            </div>
        </form> -->
</html>
    <script>
        $(document).ready(function () {
            //Fixing jQuery Click Events for the iPad
            var ua = navigator.userAgent,
                event = (ua.match(/iPad/i)) ? "touchstart" : "click";
            if ($('.table').length > 0) {
                $('.table .header').on(event, function () {
                    $(this).toggleClass("active", "").nextUntil('.header').css('display', function (i, v) {
                        return this.style.display === 'table-row' ? 'none' : 'table-row';
                    });
                });
            }
        });
        (() => {
        let customSelects = document.querySelectorAll(".custom-dropdown__select");
        customSelects.forEach(el => {
            if (el.disabled)
                el.parentNode.classList.add("custom-dropdown--disabled");
        })
    })();
    </script>